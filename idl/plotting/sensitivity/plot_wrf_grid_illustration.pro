PRO PLOT_WRF_GRID_ILLUSTRATION, EPS = eps, PNG = png

;+
; Name:
;		PLOT_WRF_GRID_ILLUSTRATION
; Purpose:
;		This is a template for creating IDL procedure files. 
; Calling sequence:
;		PLOT_WRF_GRID_ILLUSTRATION, arg1, arg2
; Input:
;		arg1 : positional parameter 1
; Output:
;		arg2 : positional parameter 2
; Keywords:
;		key1 : keyword parameter 1
; Author and history:
;		Cameron R. Homeyer  date.
;-

COMPILE_OPT IDL2																									;Set compile options


;eta_levels = [1.0000, 0.997, 0.994, 0.991, 0.988, 0.985, 0.975, $
;			 0.97, 0.96, 0.95, 0.94, 0.93, 0.92, 0.91, 0.895, $
;			 0.88, 0.865, 0.85, 0.825, 0.8, 0.7832, 0.7627, $
;			 0.7423, 0.7218, 0.7014, 0.6810, 0.6608, 0.6407, $ 
;			 0.6210, 0.6014, 0.5822, 0.5632, 0.5447, 0.5267, $
;			 0.5091, 0.4918, 0.4751, 0.4586, 0.4426, 0.4270, $
;			 0.4118, 0.3970, 0.3826, 0.3685, 0.3548, 0.3414, $
;			 0.3286, 0.3160, 0.3036, 0.2917, 0.2801, 0.2688, $
;			 0.2579, 0.2472, 0.2369, 0.2268, 0.2170, 0.2076, $
;			 0.1985, 0.1899, 0.1815, 0.1736, 0.1659, 0.1584, $
;			 0.1513, 0.1445, 0.1379, 0.1316, 0.1254, 0.1195, $
;			 0.1137, 0.1081, 0.1028, 0.0975, 0.0926, 0.0877, $
;			 0.0830, 0.0785, 0.0741, 0.0699, 0.0658, 0.0619, $
;			 0.0581, 0.0544, 0.0510, 0.0476, 0.0445, 0.0414, $
;			 0.0385, 0.0356, 0.0329, 0.0303, 0.0278, 0.0254, $
;			 0.0231, 0.0210, 0.0190, 0.0170, 0.0151, 0.0133, $
;			 0.0115, 0.0099, 0.0084, 0.0068, 0.0054, 0.0039, $
;			 0.0026, 0.0012, 0.0000]


;; 101 vertical levels from seasonal and sensitivity studies
; eta_levels = [1.0000, 0.9942, 0.9780, 0.9606, 0.9419, 0.9229, $							;eta levels for research
; 			   0.9036, 0.8839, 0.8641, 0.8440, 0.8238, 0.8035, $
;               0.7832, 0.7627, 0.7423, 0.7218, 0.7014, 0.6810, $
;               0.6608, 0.6407, 0.6210, 0.6014, 0.5822, 0.5632, $
;               0.5447, 0.5267, 0.5091, 0.4918, 0.4751, 0.4586, $
;               0.4426, 0.4270, 0.4118, 0.3970, 0.3826, 0.3685, $
;               0.3548, 0.3414, 0.3286, 0.3160, 0.3036, 0.2917, $
;               0.2801, 0.2688, 0.2579, 0.2472, 0.2369, 0.2268, $
;               0.2170, 0.2076, 0.1985, 0.1899, 0.1815, 0.1736, $
;               0.1659, 0.1584, 0.1513, 0.1445, 0.1379, 0.1316, $
;               0.1254, 0.1195, 0.1137, 0.1081, 0.1028, 0.0975, $
;               0.0926, 0.0877, 0.0830, 0.0785, 0.0741, 0.0699, $
;               0.0658, 0.0619, 0.0581, 0.0544, 0.0510, 0.0476, $
;               0.0445, 0.0414, 0.0385, 0.0356, 0.0329, 0.0303, $
;               0.0278, 0.0254, 0.0231, 0.0210, 0.0190, 0.0170, $
;               0.0151, 0.0133, 0.0115, 0.0099, 0.0084, 0.0068, $
;               0.0054, 0.0039, 0.0026, 0.0012, 0.0000]


;; 119 vertical levels, model top 26 km (20 hPa)
;eta_levels = [1.0000, 0.9942, 0.9780, 0.9606, 0.9419, 0.9229, 0.9036, 0.8839, 0.8641, 0.8440, 0.8238, 0.8035, $
;              0.7832, 0.7627, 0.7423, 0.7218, 0.7014, 0.6810, 0.6608, 0.6407, 0.6210, 0.6014, 0.5822, 0.5632, 0.5447, 0.5267, 0.5091, $
;              0.4918, 0.4751, 0.4586, 0.4426, 0.4270, 0.4118, 0.3970, 0.3826, 0.3685, 0.3548, 0.3414, 0.3286, 0.3160, 0.3036, 0.2917, $
;              0.2801, 0.2688, 0.2579, 0.2472, 0.2369, 0.2268, 0.2170, 0.2076, 0.1985, 0.1899, 0.1815, 0.1736, 0.1659, 0.1584, 0.1513, $
;              0.1445, 0.1379, 0.1316, 0.1254, 0.1195, 0.1137, 0.1081, 0.1028, 0.0975, 0.0926, 0.0877, 0.0830, 0.0785, 0.0741, 0.0699, $
;              0.0658, 0.0619, 0.0581, 0.0544, 0.0510, 0.0476, 0.0445, 0.0414, 0.0385, 0.0356, 0.0329, 0.0303, 0.0278, 0.0254, 0.0231, $
;              0.0210, 0.0190, 0.0170, 0.0151, 0.0133, 0.0115, 0.0099, 0.0084, 0.0068, 0.0054, 0.0039, 0.0026, 0.0012, 0.0000]


;; 136 vertical levels, model top 30 km (10 hPa)
eta_levels =  [1.0000, 0.9921, 0.9817, 0.9709, 0.9596, 0.9478, 0.9355, 0.9227, 0.9105, 0.8980, 0.8853, 0.8722, $
	0.8587, 0.8447, 0.8302, 0.8153, 0.7998, 0.7838, 0.7675, 0.7505, 0.7329, 0.7151, 0.6969, 0.6783, 0.6594, 0.6406, 0.6217, $
	0.6026, 0.5839, 0.5654, 0.5473, 0.5298, 0.5125, 0.4956, 0.4792, 0.4633, 0.4475, 0.4322, 0.4174, 0.4029, 0.3890, 0.3756, $
	0.3629, 0.3502, 0.3375, 0.3249, 0.3126, 0.3011, 0.2899, 0.2793, 0.2686, 0.2583, 0.2484, 0.2389, 0.2299, 0.2210, 0.2121, $
	0.2032, 0.1951, 0.1873, 0.1798, 0.1727, 0.1657, 0.1591, 0.1528, 0.1467, 0.1407, 0.1350, 0.1294, 0.1240, 0.1188, 0.1137, $
	0.1089, 0.1042, 0.0996, 0.0953, 0.0911, 0.0870, 0.0831, 0.0794, 0.0758, 0.0722, 0.0689, 0.0656, 0.0625, 0.0596, 0.0568, $
	0.0541, 0.0516, 0.0491, 0.0467, 0.0445, 0.0423, 0.0402, 0.0383, 0.0364, 0.0346, 0.0328, 0.0311, 0.0295, 0.0280, 0.0266, $
	0.0251, 0.0238, 0.0225, 0.0212, 0.0200, 0.0189, 0.0178, 0.0167, 0.0157, 0.0148, 0.0138, 0.0129, 0.0121, 0.0113, 0.0104, $
	0.0096, 0.0089, 0.0082, 0.0075, 0.0069, 0.0062, 0.0056, 0.0050, 0.0045, 0.0040, 0.0035, 0.0030, 0.0025, 0.0020, 0.0016, $
	0.0012, 0.0008, 0.0004, 0.0000]


;; 162 vertical levels for high resolution simulation
;eta_levels = [1.0000, 0.9950, 0.9870, 0.9789, 0.9706, 0.9620, $
;			  0.9533, 0.9445, 0.9354, 0.9261, 0.9166, 0.9069, $
;			  0.8970, 0.8869, 0.8766, 0.8661, 0.8556, 0.8448, $
;			  0.8340, 0.8229, 0.8116, 0.8003, 0.7890, 0.7775, $
;			  0.7660, 0.7543, 0.7425, 0.7307, 0.7189, 0.7070, $
;			  0.6951, 0.6831, 0.6712, 0.6591, 0.6469, 0.6349, $
;			  0.6232, 0.6115, 0.5997, 0.5879, 0.5766, 0.5653, $
;			  0.5539, 0.5428, 0.5320, 0.5212, 0.5104, 0.4996, $
;			  0.4893, 0.4790, 0.4689, 0.4589, 0.4492, 0.4396, $
;			  0.4302, 0.4209, 0.4116, 0.4025, 0.3936, 0.3847, $
;			  0.3759, 0.3674, 0.3590, 0.3507, 0.3427, 0.3348, $
;			  0.3269, 0.3192, 0.3117, 0.3044, 0.2970, 0.2897, $
;			  0.2827, 0.2758, 0.2691, 0.2625, 0.2559, 0.2493, $
;			  0.2429, 0.2367, 0.2306, 0.2247, 0.2188, 0.2130, $
;			  0.2074, 0.2018, 0.1964, 0.1911, 0.1859, 0.1807, $
;			  0.1756, 0.1707, 0.1658, 0.1612, 0.1566, 0.1519, $
;			  0.1474, 0.1432, 0.1389, 0.1347, 0.1307, 0.1267, $
;			  0.1228, 0.1191, 0.1154, 0.1118, 0.1083, 0.1049, $
;			  0.1015, 0.0982, 0.0951, 0.0919, 0.0887, 0.0857, $
;			  0.0828, 0.0799, 0.0771, 0.0742, 0.0714, 0.0687, $
;			  0.0661, 0.0636, 0.0610, 0.0587, 0.0563, 0.0539, $
;			  0.0517, 0.0495, 0.0475, 0.0454, 0.0434, 0.0414, $
;			  0.0394, 0.0376, 0.0357, 0.0339, 0.0321, 0.0304, $
;			  0.0287, 0.0271, 0.0254, 0.0239, 0.0224, 0.0209, $
;			  0.0195, 0.0181, 0.0168, 0.0154, 0.0141, 0.0128, $
;			  0.0116, 0.0104, 0.0093, 0.0081, 0.0070, 0.0059, $
;			  0.0049, 0.0039, 0.0029, 0.0019, 0.0009, 0.0000]
			  
p = 990.0*eta_levels + 10.0
z = PRESSURE_ALTITUDE(p, /km)

PRINT, z
epsfile = '~/wrfprofile.eps'
pngfile = '~/wrfprofile.eps'

IF KEYWORD_SET(eps) THEN BEGIN	
	PS_ON, FILENAME = epsfile, PAGE_SIZE = [7.0, 8.0], MARGIN = 0.0, /INCHES					;Switch to Postscript device
	DEVICE, /ENCAPSULATED
	!P.FONT     = 0																								;Hardware fonts
	!P.CHARSIZE = 1.5
	IF (LONG((STRSPLIT(!VERSION.RELEASE, '.', /EXTRACT))[0]) LE 7) THEN $
		LOAD_BASIC_COLORS																							;Load basic color definitions
ENDIF ELSE BEGIN
	SET_PLOT, 'X'
	WINDOW, XSIZE = 700, YSIZE = 800																		;Open graphics window
	!P.COLOR      = COLOR_24('black')																		;Foreground color
	!P.BACKGROUND = COLOR_24('white')																		;Background color
	!P.CHARSIZE   = 2.75	
	!P.FONT       = -1																							;Use Hershey fonts
ENDELSE

dz     = 0.5*(SHIFT(z, -1) - SHIFT(z, 1))
dz[ 0] = z[ 1] - z[ 0]
dz[-1] = z[-1] - z[-2]

PLOT, GAUSS_SMOOTH(dz,3, /EDGE_TRUNCATE), z, THICK = 2, $
	XRANGE = [0,1], $
	XSTYLE = 1, $
	XTITLE = 'Vertical Resolution (km)', $
	YRANGE = [0.0, 30.0], $
	YSTYLE = 1, $
	YTITLE = 'Altitude (km)'

z2 = z[0] + TOTAL(GAUSS_SMOOTH(dz,3, /EDGE_TRUNCATE), /CUM)

USERSYM_CIRCLE, /FILL
PLOTS, REPLICATE(0.9, N_ELEMENTS(z)), z2, PSYM = 8, SYMSIZE = 2 - 0.5*KEYWORD_SET(eps), NOCLIP = 0

IF KEYWORD_SET(eps) THEN BEGIN
	IF (LONG((STRSPLIT(!VERSION.RELEASE, '.', /EXTRACT))[0]) LE 7) THEN $
		LOAD_BASIC_COLORS, /RESET																				;Reset color table to linear ramp
	PS_OFF																											;Turn PS off
ENDIF ELSE IF KEYWORD_SET(png) THEN $
	WRITE_PNG, pngfile, TVRD(TRUE = 1)																		;Write PNG file


END
